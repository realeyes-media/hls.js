{"version":3,"sources":["webpack://HlsDemo/webpack/universalModuleDefinition","webpack://HlsDemo/webpack/bootstrap","webpack://HlsDemo/./demo/demo-utils.js","webpack://HlsDemo/./demo/main.js","webpack://HlsDemo/./tests/test-streams.js"],"names":["sortObject","obj","temp","keys","key","push","sort","index","copyTextToClipboard","text","textArea","document","createElement","value","body","appendChild","select","successful","execCommand","msg","console","log","err","removeChild","STORAGE_KEYS","Editor_Persistence","Hls_Config","testStreams","require","defaultTestStreamUrl","url","sourceURL","decodeURIComponent","getURLParam","demoConfig","JSON","parse","atob","hlsjsDefaults","debug","enableWorker","enableStreaming","getDemoConfigPropOrDefault","autoRecoverError","levelCapping","limitMetrics","dumpfMP4","bufferingIdx","selectedTestStream","video","$","startTime","Date","now","lastSeekingIdx","lastStartPosition","lastDuration","lastAudioTrackSwitchingIdx","hls","events","stats","tracks","fmp4Data","configPersistenceEnabled","configEditor","ready","setupConfigEditor","Object","forEach","stream","option","Option","description","append","change","val","streamUrl","loadSelectedStream","width","click","checked","onDemoConfigChanged","prop","Hls","version","html","volume","hideAllTabs","toggle","windowSliding","setupGlobals","window","t0","performance","load","buffer","level","bitrate","recoverDecodingErrorDate","recoverSwapAudioCodecDate","onClickBufferedRange","updateLevelInfo","createfMP4","goToMetricsPermaLink","toggleTab","applyConfigEditorValue","trimArray","target","limit","length","shift","trimEventHistory","x","isSupported","handleUnsupported","hideCanvas","destroy","bufferTimer","clearInterval","undefined","logStatus","hlsConfig","extend","getEditorValue","config","info","updateConfigEditorValue","loadSource","autoLevelCapping","attachMedia","on","Events","MEDIA_ATTACHED","time","type","MEDIA_DETACHED","FRAG_PARSING_INIT_SEGMENT","event","data","showCanvas","id","FRAG_PARSING_METADATA","LEVEL_SWITCHING","Math","round","levels","MANIFEST_PARSED","name","start","end","trequest","latency","tfirst","tload","duration","refreshCanvas","levelNb","levelParsed","AUDIO_TRACKS_UPDATED","audioTracks","updateAudioTrackInfo","AUDIO_TRACK_SWITCHING","AUDIO_TRACK_SWITCHED","LEVEL_LOADED","isLive","details","live","startSN","endSN","parsing","tparsed","parsingDuration","sumLevelParsingMs","levelParsingUs","AUDIO_TRACK_LOADED","FRAG_BUFFERED","frag","id2","sn","tbuffered","bw","total","size","pos","setInterval","checkBuffer","process","fragBuffered","fragMinLatency","min","fragMaxLatency","max","fragMinProcess","fragMaxProcess","fragMinKbps","fragMaxKbps","autoLevelCappingMin","autoLevelCappingMax","fragBufferedBytes","sumLatency","sumKbps","sumProcess","sumParsing","fraglastLatency","fragAvgLatency","fragLastProcess","fragAvgProcess","fragLastKbps","fragAvgKbps","fragparsingKbps","fragparsingMs","autoLevelCappingLast","LEVEL_SWITCHED","FRAG_CHANGED","tagList","autoLevel","levelStart","fragChangedAuto","autoLevelMin","autoLevelMax","levelLastAuto","autoLevelLast","autoLevelSwitch","sumAutoLevel","autoLevelAvg","fragChangedManual","manualLevelMin","manualLevelMax","manualLevelLast","manualLevelSwitch","FRAG_LOAD_EMERGENCY_ABORTED","fragLoadEmergencyAborted","FRAG_DECRYPTED","fragDecrypted","totalDecryptTime","fragAvgDecryptTime","tdecrypt","tstart","ERROR","warn","ErrorDetails","MANIFEST_LOAD_ERROR","context","response","code","MANIFEST_LOAD_TIMEOUT","logError","MANIFEST_PARSING_ERROR","reason","LEVEL_LOAD_ERROR","LEVEL_LOAD_TIMEOUT","LEVEL_SWITCH_ERROR","FRAG_LOAD_ERROR","FRAG_LOAD_TIMEOUT","FRAG_LOOP_LOADING_ERROR","FRAG_DECRYPT_ERROR","FRAG_PARSING_ERROR","KEY_LOAD_ERROR","decryptdata","uri","KEY_LOAD_TIMEOUT","BUFFER_APPEND_ERROR","BUFFER_ADD_CODEC_ERROR","mimeType","message","BUFFER_APPENDING_ERROR","BUFFER_STALLED_ERROR","fatal","error","ErrorTypes","MEDIA_ERROR","handleMediaError","NETWORK_ERROR","fatalError","stringify","BUFFER_CREATED","BUFFER_APPENDING","FPS_DROP","evt","currentDropped","currentDecoded","fpsDropEvent","fpsTotalDroppedFrames","totalDroppedFrames","addEventListener","handleVideoEvent","navigator","userAgent","toLowerCase","indexOf","videoWidth","videoHeight","currentTime","errorTxt","mediaError","currentTarget","MEDIA_ERR_ABORTED","MEDIA_ERR_DECODE","MEDIA_ERR_NETWORK","MEDIA_ERR_SRC_NOT_SUPPORTED","recoverMediaError","swapAudioCodec","timeRangesToString","r","i","v","canvas","ctx","getContext","buffered","bufferingDuration","fillStyle","fillRect","height","clientWidth","bufferLen","paused","bufEvents","bufEventLen","event0","event1","slopeBuf0","slopeBuf1","slopePos0","slopePos1","abs","pop","seekable","played","media","videoPlaybackQuality","getVideoPlaybackQuality","Function","droppedVideoFrames","corruptedVideoFrames","webkitDroppedFrameCount","showMetrics","show","hideMetrics","hide","getMetrics","json","jsonpacked","jsonpack","pack","btoa","copyMetricsToClipBoard","goToMetrics","URL","substr","lastIndexOf","open","b64","minsecs","ts","m","floor","s","clientX","offsetLeft","button_template","button_enabled","button_disabled","html1","autoLevelEnabled","html2","html3","html4","currentLevel","levelName","label","level2label","loadLevel","nextLevel","audioTrackId","audioTrack","len","propName","defaultVal","sParam","defaultValue","sPageURL","location","search","substring","sURLVariables","split","sParameterName","persistEditorValue","serializedDemoConfig","baseURL","streamURL","permalinkURL","encodeURIComponent","onConfigPersistenceChanged","localStorage","setItem","removeItem","options","session","getValue","e","getPersistedHlsConfig","getItem","ace","edit","setTheme","setMode","contents","shouldRestorePersisted","elPersistence","querySelector","setValue","blob","Blob","arrayConcat","filename","toISOString","saveAs","inputArray","totalLength","reduce","prev","cur","result","Uint8Array","offset","element","set","tabElId","appendLog","textElId","el","logText","timestamp","newMessage","createTestStream","abr","blacklist_ua","createTestStreamWithConfig","Error","testStream","module","exports","bbb","nudgeMaxRetry","bigBuckBunny480p","arte","deltatreDAI","issue666","closedCaptions","oceansAES","mp3Audio","mpegAudioOnly","fmp4","fmp4Bitmovin","offset_pts","angelOneShakaWidevine","emeEnabled","requestMediaKeySystemAccessFunc","supportedConfigurations","keySystem","requestMediaKeySystemAccess","getEMEInitializationDataFunc","levelOrAudioTrack","initDataType","initData","Promise","resolve","getEMELicenseFunc","licenseServerUrl","licenseXhr","XMLHttpRequest","licensePromise","reject","onload","onerror","responseType","send","NOTE","audioOnlyMultipleLevels","pdtDuplicate","pdtLargeGap","pdtBadValues","pdtOneValue","noTrackIntersection","altAudioAndTracks"],"mappings":"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","file":"hls-demo.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"HlsDemo\"] = factory();\n\telse\n\t\troot[\"HlsDemo\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./demo/main.js\");\n","export function sortObject(obj) {\r\n  if(typeof obj !== 'object') {\r\n    return obj;\r\n  }\r\n  let temp = {};\r\n  let keys = [];\r\n  for(let key in obj) {\r\n    keys.push(key);\r\n  }\r\n  keys.sort();\r\n  for(let index in keys) {\r\n    temp[keys[index]] = sortObject(obj[keys[index]]);\r\n  }\r\n  return temp;\r\n}\r\n\r\nexport function copyTextToClipboard(text) {\r\n  let textArea = document.createElement('textarea');\r\n  textArea.value = text;\r\n  document.body.appendChild(textArea);\r\n  textArea.select();\r\n  try {\r\n    let successful = document.execCommand('copy');\r\n    let msg = successful ? 'successful' : 'unsuccessful';\r\n    console.log('Copying text command was ' + msg);\r\n  } catch (err) {\r\n    console.log('Oops, unable to copy');\r\n  }\r\n  document.body.removeChild(textArea);\r\n}\r\n\r\n","import {sortObject, copyTextToClipboard} from './demo-utils'\r\n\r\nconst STORAGE_KEYS = {\r\n  Editor_Persistence: 'hlsjs:config-editor-persist',\r\n  Hls_Config        : 'hlsjs:config'\r\n};\r\n\r\nconst testStreams = require('../tests/test-streams');\r\nconst defaultTestStreamUrl = testStreams['bbb'].url;\r\nconst sourceURL = decodeURIComponent(getURLParam('src', defaultTestStreamUrl))\r\n\r\nlet demoConfig = getURLParam('demoConfig', null)\r\nif (demoConfig) {\r\n  demoConfig = JSON.parse(atob(demoConfig))\r\n} else {\r\n  demoConfig = {}\r\n}\r\n\r\nconst hlsjsDefaults = {\r\n  debug: true,\r\n  enableWorker: true\r\n};\r\n\r\nlet enableStreaming = getDemoConfigPropOrDefault('enableStreaming', true);\r\nlet autoRecoverError = getDemoConfigPropOrDefault('autoRecoverError', true);\r\nlet levelCapping = getDemoConfigPropOrDefault('levelCapping', -1);\r\nlet limitMetrics = getDemoConfigPropOrDefault('limitMetrics', -1);\r\nlet dumpfMP4 = getDemoConfigPropOrDefault('dumpfMP4', false);\r\n\r\nlet bufferingIdx = -1;\r\nlet selectedTestStream = null;\r\nlet video = $('#video')[0];\r\nlet startTime = Date.now()\r\n\r\nlet lastSeekingIdx;\r\nlet lastStartPosition;\r\nlet lastDuration;\r\nlet lastAudioTrackSwitchingIdx;\r\nlet hls;\r\nlet url;\r\nlet events;\r\nlet stats;\r\nlet tracks;\r\nlet fmp4Data;\r\nlet configPersistenceEnabled = false;\r\nlet configEditor = null;\r\n\r\n$(document).ready(function() {\r\n  setupConfigEditor();\r\n\r\n  Object.keys(testStreams).forEach((key) => {\r\n    const stream = testStreams[key];\r\n    const option = new Option(stream.description, key);\r\n    $('#streamSelect').append(option);\r\n  })\r\n\r\n  $('#streamSelect').change(function() {\r\n    selectedTestStream = testStreams[$('#streamSelect').val()];\r\n    const streamUrl = selectedTestStream.url;\r\n    $('#streamURL').val(streamUrl);\r\n    loadSelectedStream();\r\n  });\r\n\r\n  $('#streamURL').change(function() {\r\n    selectedTestStream = null;\r\n    loadSelectedStream();\r\n  });\r\n\r\n  $('#videoSize').change(function() {\r\n    $('#video').width($('#videoSize').val());\r\n    $('#bufferedCanvas').width($('#videoSize').val());\r\n  });\r\n\r\n  $('#enableStreaming').click(function() {\r\n    enableStreaming = this.checked;\r\n    loadSelectedStream();\r\n  });\r\n\r\n  $('#autoRecoverError').click(function() {\r\n    autoRecoverError = this.checked;\r\n    onDemoConfigChanged();\r\n  });\r\n\r\n  $('#dumpfMP4').click(function() {\r\n    dumpfMP4 = this.checked;\r\n    onDemoConfigChanged();\r\n  });\r\n\r\n  $('#limitMetrics').change(function() {\r\n    limitMetrics = this.value;\r\n    onDemoConfigChanged();\r\n  })\r\n\r\n  $('#levelCapping').change(function() {\r\n    levelCapping = this.value;\r\n    onDemoConfigChanged();\r\n  });\r\n\r\n  $('#limitMetrics').val(limitMetrics);\r\n  $('#enableStreaming').prop('checked', enableStreaming );\r\n  $('#autoRecoverError').prop('checked', autoRecoverError );\r\n  $('#dumpfMP4').prop('checked', dumpfMP4 );\r\n  $('#levelCapping').val(levelCapping);\r\n\r\n  $('h2').append('&nbsp;<a target=_blank href=https://github.com/video-dev/hls.js/releases/tag/v' + Hls.version + '>v' + Hls.version + '</a>');\r\n  $('#currentVersion').html('Hls version:' + Hls.version);\r\n\r\n  $('#streamURL').val(sourceURL)\r\n\r\n  video.volume = 0.05;\r\n\r\n  hideAllTabs();\r\n\r\n  $('#metricsButtonWindow').toggle(windowSliding);\r\n  $('#metricsButtonFixed').toggle(!windowSliding);\r\n\r\n  loadSelectedStream();\r\n\r\n});\r\n\r\nfunction setupGlobals() {\r\n  window.events = events = {\r\n    url    : url,\r\n    t0     : performance.now(),\r\n    load   : [],\r\n    buffer : [],\r\n    video  : [],\r\n    level  : [],\r\n    bitrate: []\r\n  };\r\n\r\n  // actual values, only on window\r\n  window.recoverDecodingErrorDate = null;\r\n  window.recoverSwapAudioCodecDate = null;\r\n\r\n  window.fmp4Data = fmp4Data = {\r\n    'audio': [],\r\n    'video': []\r\n  };\r\n\r\n  window.onClickBufferedRange = onClickBufferedRange;\r\n\r\n  window.updateLevelInfo = updateLevelInfo;\r\n  window.onDemoConfigChanged = onDemoConfigChanged;\r\n  window.createfMP4 = createfMP4;\r\n  window.goToMetricsPermaLink = goToMetricsPermaLink;\r\n  window.toggleTab = toggleTab;\r\n  window.applyConfigEditorValue = applyConfigEditorValue;\r\n}\r\n\r\nfunction trimArray( target, limit ) {\r\n  if( limit < 0 ) {\r\n    return;\r\n  }\r\n\r\n  while(target.length > limit )\r\n  {\r\n    target.shift();\r\n  }\r\n}\r\n\r\nfunction trimEventHistory() {\r\n  const x = limitMetrics;\r\n\r\n  if(x < 0) {\r\n    return;\r\n  }\r\n\r\n  trimArray(events.load, x);\r\n  trimArray(events.buffer, x);\r\n  trimArray(events.video, x);\r\n  trimArray(events.level, x);\r\n  trimArray(events.bitrate, x);\r\n}\r\n\r\nfunction loadSelectedStream() {\r\n\r\n  if (!Hls.isSupported()) {\r\n    handleUnsupported();\r\n    return;\r\n  }\r\n\r\n  url = $('#streamURL').val()\r\n\r\n  setupGlobals();\r\n  hideCanvas();\r\n\r\n  if(hls) {\r\n    hls.destroy();\r\n    if(hls.bufferTimer) {\r\n      clearInterval(hls.bufferTimer);\r\n      hls.bufferTimer = undefined;\r\n    }\r\n    hls = null;\r\n  }\r\n\r\n  if(!enableStreaming) {\r\n    logStatus('Streaming disabled');\r\n    return;\r\n  }\r\n\r\n  logStatus('Loading ' + url);\r\n\r\n\r\n  // Extending both a demo-specific config and the user config which can override all\r\n  const hlsConfig = $.extend({}, hlsjsDefaults, getEditorValue({ parse: true }));\r\n\r\n  if (selectedTestStream && selectedTestStream.config) {\r\n    console.info('[loadSelectedStream] extending hls config with stream-specific config: ', selectedTestStream.config);\r\n    $.extend(hlsConfig, selectedTestStream.config);\r\n    updateConfigEditorValue(hlsConfig);\r\n  }\r\n\r\n  onDemoConfigChanged();\r\n  console.log('Using Hls.js config:', hlsConfig);\r\n\r\n  window.hls = hls = new Hls(hlsConfig);\r\n\r\n  logStatus('Loading manifest and attaching video element...');\r\n\r\n  hls.loadSource(url);\r\n  hls.autoLevelCapping = levelCapping;\r\n  hls.attachMedia(video);\r\n\r\n  hls.on(Hls.Events.MEDIA_ATTACHED, function() {\r\n    logStatus('Media element attached');\r\n    bufferingIdx = -1;\r\n    events.video.push({\r\n      time: performance.now() - events.t0,\r\n      type: 'Media attached'\r\n    });\r\n    trimEventHistory();\r\n  });\r\n\r\n  hls.on(Hls.Events.MEDIA_DETACHED, function() {\r\n    logStatus('Media element detached');\r\n    bufferingIdx = -1;\r\n    tracks = [];\r\n    events.video.push({\r\n      time: performance.now() - events.t0,\r\n      type: 'Media detached'\r\n    });\r\n    trimEventHistory();\r\n  });\r\n\r\n  hls.on(Hls.Events.FRAG_PARSING_INIT_SEGMENT, function(event, data) {\r\n    showCanvas();\r\n    var event = {\r\n      time: performance.now() - events.t0,\r\n      type: data.id + ' init segment'\r\n    };\r\n    events.video.push(event);\r\n    trimEventHistory();\r\n  });\r\n\r\n  hls.on(Hls.Events.FRAG_PARSING_METADATA, function(event, data) {\r\n    //console.log(\"Id3 samples \", data.samples);\r\n  });\r\n\r\n  hls.on(Hls.Events.LEVEL_SWITCHING, function(event, data) {\r\n    events.level.push({\r\n      time   : performance.now() - events.t0,\r\n      id     : data.level,\r\n      bitrate: Math.round(hls.levels[data.level].bitrate/1000)\r\n    });\r\n    trimEventHistory();\r\n    updateLevelInfo();\r\n  });\r\n\r\n  hls.on(Hls.Events.MANIFEST_PARSED, function(event, data) {\r\n    var event = {\r\n      type    : 'manifest',\r\n      name    : '',\r\n      start   : 0,\r\n      end     : data.levels.length,\r\n      time    : data.stats.trequest - events.t0,\r\n      latency : data.stats.tfirst - data.stats.trequest,\r\n      load    : data.stats.tload - data.stats.tfirst,\r\n      duration: data.stats.tload - data.stats.tfirst,\r\n    };\r\n    events.load.push(event);\r\n    trimEventHistory();\r\n    refreshCanvas();\r\n  });\r\n\r\n  hls.on(Hls.Events.MANIFEST_PARSED, function(event, data) {\r\n    logStatus('No of quality levels found: ' + hls.levels.length);\r\n    logStatus('Manifest successfully loaded');\r\n    stats = {\r\n      levelNb    : data.levels.length,\r\n      levelParsed: 0\r\n    };\r\n    trimEventHistory();\r\n    updateLevelInfo();\r\n  });\r\n\r\n  hls.on(Hls.Events.AUDIO_TRACKS_UPDATED, function(event, data) {\r\n    logStatus('No of audio tracks found: ' + data.audioTracks.length);\r\n    updateAudioTrackInfo();\r\n  });\r\n\r\n  hls.on(Hls.Events.AUDIO_TRACK_SWITCHING, function(event, data) {\r\n    logStatus('Audio track switching...');\r\n    updateAudioTrackInfo();\r\n    var event = {\r\n      time: performance.now() - events.t0,\r\n      type: 'audio switching',\r\n      name: '@' + data.id\r\n    };\r\n    events.video.push(event);\r\n    trimEventHistory();\r\n    lastAudioTrackSwitchingIdx = events.video.length-1;\r\n  });\r\n\r\n  hls.on(Hls.Events.AUDIO_TRACK_SWITCHED, function(event, data) {\r\n    logStatus('Audio track switched');\r\n    updateAudioTrackInfo();\r\n    var event = {\r\n      time: performance.now() - events.t0,\r\n      type: 'audio switched',\r\n      name: '@' + data.id\r\n    };\r\n    if (lastAudioTrackSwitchingIdx !== undefined) {\r\n      events.video[lastAudioTrackSwitchingIdx].duration = event.time - events.video[lastAudioTrackSwitchingIdx].time;\r\n      lastAudioTrackSwitchingIdx = undefined;\r\n    }\r\n    events.video.push(event);\r\n    trimEventHistory();\r\n  });\r\n\r\n  hls.on(Hls.Events.LEVEL_LOADED, function(event, data) {\r\n    events.isLive = data.details.live;\r\n    var event = {\r\n      type    : 'level',\r\n      id      : data.level,\r\n      start   : data.details.startSN,\r\n      end     : data.details.endSN,\r\n      time    : data.stats.trequest - events.t0,\r\n      latency : data.stats.tfirst - data.stats.trequest,\r\n      load    : data.stats.tload - data.stats.tfirst,\r\n      parsing : data.stats.tparsed - data.stats.tload,\r\n      duration: data.stats.tload - data.stats.tfirst\r\n    };\r\n    const parsingDuration = data.stats.tparsed - data.stats.tload;\r\n    if (stats.levelParsed)\r\n    {this.sumLevelParsingMs += parsingDuration;}\r\n    else\r\n    {this.sumLevelParsingMs = parsingDuration;}\r\n\r\n    stats.levelParsed++;\r\n    stats.levelParsingUs = Math.round(1000*this.sumLevelParsingMs / stats.levelParsed);\r\n\r\n    //console.log('parsing level duration :' + stats.levelParsingUs + 'us,count:' + stats.levelParsed);\r\n\r\n    events.load.push(event);\r\n    trimEventHistory();\r\n    refreshCanvas();\r\n  });\r\n\r\n  hls.on(Hls.Events.AUDIO_TRACK_LOADED, function(event, data) {\r\n    events.isLive = data.details.live;\r\n    var event = {\r\n      type    : 'audio track',\r\n      id      : data.id,\r\n      start   : data.details.startSN,\r\n      end     : data.details.endSN,\r\n      time    : data.stats.trequest - events.t0,\r\n      latency : data.stats.tfirst - data.stats.trequest,\r\n      load    : data.stats.tload - data.stats.tfirst,\r\n      parsing : data.stats.tparsed - data.stats.tload,\r\n      duration: data.stats.tload - data.stats.tfirst\r\n    };\r\n    events.load.push(event);\r\n    trimEventHistory();\r\n    refreshCanvas();\r\n  });\r\n\r\n  hls.on(Hls.Events.FRAG_BUFFERED, function(event, data) {\r\n    var event = {\r\n      type    : data.frag.type + ' fragment',\r\n      id      : data.frag.level,\r\n      id2     : data.frag.sn,\r\n      time    : data.stats.trequest - events.t0,\r\n      latency : data.stats.tfirst - data.stats.trequest,\r\n      load    : data.stats.tload - data.stats.tfirst,\r\n      parsing : data.stats.tparsed - data.stats.tload,\r\n      buffer  : data.stats.tbuffered - data.stats.tparsed,\r\n      duration: data.stats.tbuffered - data.stats.tfirst,\r\n      bw      : Math.round(8*data.stats.total/(data.stats.tbuffered - data.stats.trequest)),\r\n      size    : data.stats.total\r\n    };\r\n    events.load.push(event);\r\n    events.bitrate.push({\r\n      time    : performance.now() - events.t0,\r\n      bitrate : event.bw,\r\n      duration: data.frag.duration,\r\n      level   : event.id\r\n    });\r\n    if(hls.bufferTimer === undefined) {\r\n      events.buffer.push({\r\n        time  : 0,\r\n        buffer: 0,\r\n        pos   : 0\r\n      });\r\n      hls.bufferTimer = window.setInterval(checkBuffer, 100);\r\n    }\r\n    trimEventHistory();\r\n    refreshCanvas();\r\n    updateLevelInfo();\r\n\r\n    let latency = data.stats.tfirst - data.stats.trequest,\r\n      parsing = data.stats.tparsed - data.stats.tload,\r\n      process = data.stats.tbuffered - data.stats.trequest,\r\n      bitrate = Math.round(8 * data.stats.length / (data.stats.tbuffered - data.stats.tfirst));\r\n    if (stats.fragBuffered) {\r\n      stats.fragMinLatency = Math.min(stats.fragMinLatency, latency);\r\n      stats.fragMaxLatency = Math.max(stats.fragMaxLatency, latency);\r\n      stats.fragMinProcess = Math.min(stats.fragMinProcess, process);\r\n      stats.fragMaxProcess = Math.max(stats.fragMaxProcess, process);\r\n      stats.fragMinKbps = Math.min(stats.fragMinKbps, bitrate);\r\n      stats.fragMaxKbps = Math.max(stats.fragMaxKbps, bitrate);\r\n      stats.autoLevelCappingMin = Math.min(stats.autoLevelCappingMin, hls.autoLevelCapping);\r\n      stats.autoLevelCappingMax = Math.max(stats.autoLevelCappingMax, hls.autoLevelCapping);\r\n      stats.fragBuffered++;\r\n    } else {\r\n      stats.fragMinLatency = stats.fragMaxLatency = latency;\r\n      stats.fragMinProcess = stats.fragMaxProcess = process;\r\n      stats.fragMinKbps = stats.fragMaxKbps = bitrate;\r\n      stats.fragBuffered = 1;\r\n      stats.fragBufferedBytes = 0;\r\n      stats.autoLevelCappingMin = stats.autoLevelCappingMax = hls.autoLevelCapping;\r\n      this.sumLatency = 0;\r\n      this.sumKbps = 0;\r\n      this.sumProcess = 0;\r\n      this.sumParsing = 0;\r\n    }\r\n    stats.fraglastLatency = latency;\r\n    this.sumLatency += latency;\r\n    stats.fragAvgLatency = Math.round(this.sumLatency / stats.fragBuffered);\r\n    stats.fragLastProcess = process;\r\n    this.sumProcess += process;\r\n    this.sumParsing += parsing;\r\n    stats.fragAvgProcess = Math.round(this.sumProcess / stats.fragBuffered);\r\n    stats.fragLastKbps = bitrate;\r\n    this.sumKbps += bitrate;\r\n    stats.fragAvgKbps = Math.round(this.sumKbps / stats.fragBuffered);\r\n    stats.fragBufferedBytes += data.stats.total;\r\n    stats.fragparsingKbps = Math.round(8*stats.fragBufferedBytes / this.sumParsing);\r\n    stats.fragparsingMs = Math.round(this.sumParsing);\r\n    stats.autoLevelCappingLast = hls.autoLevelCapping;\r\n  });\r\n\r\n  hls.on(Hls.Events.LEVEL_SWITCHED, function(event, data) {\r\n    var event = {\r\n      time: performance.now() - events.t0,\r\n      type: 'level switched',\r\n      name: data.level\r\n    };\r\n    events.video.push(event);\r\n    trimEventHistory();\r\n    refreshCanvas();\r\n    updateLevelInfo();\r\n  });\r\n\r\n  hls.on(Hls.Events.FRAG_CHANGED, function(event, data) {\r\n    var event = {\r\n      time: performance.now() - events.t0,\r\n      type: 'frag changed',\r\n      name: data.frag.sn + ' @ ' + data.frag.level\r\n    };\r\n    events.video.push(event);\r\n    trimEventHistory();\r\n    refreshCanvas();\r\n    updateLevelInfo();\r\n    stats.tagList = data.frag.tagList;\r\n\r\n    let level = data.frag.level, autoLevel = data.frag.autoLevel;\r\n    if (stats.levelStart === undefined)\r\n    {stats.levelStart = level;}\r\n\r\n    if (autoLevel) {\r\n      if (stats.fragChangedAuto) {\r\n        stats.autoLevelMin = Math.min(stats.autoLevelMin, level);\r\n        stats.autoLevelMax = Math.max(stats.autoLevelMax, level);\r\n        stats.fragChangedAuto++;\r\n        if (this.levelLastAuto && level !== stats.autoLevelLast)\r\n        {stats.autoLevelSwitch++;}\r\n\r\n      } else {\r\n        stats.autoLevelMin = stats.autoLevelMax = level;\r\n        stats.autoLevelSwitch = 0;\r\n        stats.fragChangedAuto = 1;\r\n        this.sumAutoLevel = 0;\r\n      }\r\n      this.sumAutoLevel += level;\r\n      stats.autoLevelAvg = Math.round(1000 * this.sumAutoLevel / stats.fragChangedAuto) / 1000;\r\n      stats.autoLevelLast = level;\r\n    } else {\r\n      if (stats.fragChangedManual) {\r\n        stats.manualLevelMin = Math.min(stats.manualLevelMin, level);\r\n        stats.manualLevelMax = Math.max(stats.manualLevelMax, level);\r\n        stats.fragChangedManual++;\r\n        if (!this.levelLastAuto && level !== stats.manualLevelLast)\r\n        {stats.manualLevelSwitch++;}\r\n\r\n      } else {\r\n        stats.manualLevelMin = stats.manualLevelMax = level;\r\n        stats.manualLevelSwitch = 0;\r\n        stats.fragChangedManual = 1;\r\n      }\r\n      stats.manualLevelLast = level;\r\n    }\r\n    this.levelLastAuto = autoLevel;\r\n  });\r\n\r\n  hls.on(Hls.Events.FRAG_LOAD_EMERGENCY_ABORTED, function(event, data) {\r\n    if (stats) {\r\n      if (stats.fragLoadEmergencyAborted === undefined)\r\n      {stats.fragLoadEmergencyAborted = 1;}\r\n      else\r\n      {stats.fragLoadEmergencyAborted++;}\r\n\r\n    }\r\n  });\r\n\r\n  hls.on(Hls.Events.FRAG_DECRYPTED, function(event, data) {\r\n    if (!stats.fragDecrypted) {\r\n      stats.fragDecrypted = 0;\r\n      this.totalDecryptTime = 0;\r\n      stats.fragAvgDecryptTime = 0;\r\n    }\r\n    stats.fragDecrypted++;\r\n    this.totalDecryptTime += data.stats.tdecrypt - data.stats.tstart;\r\n    stats.fragAvgDecryptTime = this.totalDecryptTime / stats.fragDecrypted;\r\n  });\r\n\r\n  hls.on(Hls.Events.ERROR, function(event, data) {\r\n    console.warn('Error event:', data);\r\n    switch(data.details) {\r\n      case Hls.ErrorDetails.MANIFEST_LOAD_ERROR:\r\n        try {\r\n          $('#errorOut').html('Cannot load <a href=\"' + data.context.url + '\">' + url + '</a><br>HTTP response code:' + data.response.code + ' <br>' + data.response.text);\r\n          if(data.response.code === 0){\r\n            $('#errorOut').append('This might be a CORS issue, consider installing <a href=\"https://chrome.google.com/webstore/detail/allow-control-allow-origi/nlfbmbojpeacfghkpbjhddihlkkiljbi\">Allow-Control-Allow-Origin</a> Chrome Extension');\r\n          }\r\n        } catch(err) {\r\n          $('#errorOut').html('Cannot load <a href=\"' + data.context.url + '\">' + url + '</a><br>Response body: ' + data.response.text);\r\n        }\r\n        break;\r\n      case Hls.ErrorDetails.MANIFEST_LOAD_TIMEOUT:\r\n        logError('Timeout while loading manifest');\r\n        break;\r\n      case Hls.ErrorDetails.MANIFEST_PARSING_ERROR:\r\n        logError('Error while parsing manifest:' + data.reason);\r\n        break;\r\n      case Hls.ErrorDetails.LEVEL_LOAD_ERROR:\r\n        logError('Error while loading level playlist');\r\n        break;\r\n      case Hls.ErrorDetails.LEVEL_LOAD_TIMEOUT:\r\n        logError('Timeout while loading level playlist');\r\n        break;\r\n      case Hls.ErrorDetails.LEVEL_SWITCH_ERROR:\r\n        logError('Error while trying to switch to level ' + data.level);\r\n        break;\r\n      case Hls.ErrorDetails.FRAG_LOAD_ERROR:\r\n        logError('Error while loading fragment ' + data.frag.url);\r\n        break;\r\n      case Hls.ErrorDetails.FRAG_LOAD_TIMEOUT:\r\n        logError('Timeout while loading fragment ' + data.frag.url);\r\n        break;\r\n      case Hls.ErrorDetails.FRAG_LOOP_LOADING_ERROR:\r\n        logError('Fragment-loop loading error');\r\n        break;\r\n      case Hls.ErrorDetails.FRAG_DECRYPT_ERROR:\r\n        logError('Decrypting error:' + data.reason);\r\n        break;\r\n      case Hls.ErrorDetails.FRAG_PARSING_ERROR:\r\n        logError('Parsing error:' + data.reason);\r\n        break;\r\n      case Hls.ErrorDetails.KEY_LOAD_ERROR:\r\n        logError('Error while loading key ' + data.frag.decryptdata.uri);\r\n        break;\r\n      case Hls.ErrorDetails.KEY_LOAD_TIMEOUT:\r\n        logError('Timeout while loading key ' + data.frag.decryptdata.uri);\r\n        break;\r\n      case Hls.ErrorDetails.BUFFER_APPEND_ERROR:\r\n        logError('Buffer append error');\r\n        break;\r\n      case Hls.ErrorDetails.BUFFER_ADD_CODEC_ERROR:\r\n        logError('Buffer add codec error for ' + data.mimeType + ':' + data.err.message);\r\n        break;\r\n      case Hls.ErrorDetails.BUFFER_APPENDING_ERROR:\r\n        logError('Buffer appending error');\r\n        break;\r\n      case Hls.ErrorDetails.BUFFER_STALLED_ERROR:\r\n        logError('Buffer stalled error');\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    if(data.fatal) {\r\n      console.error('Fatal error :' + data.details);\r\n      switch(data.type) {\r\n        case Hls.ErrorTypes.MEDIA_ERROR:\r\n          handleMediaError();\r\n          break;\r\n        case Hls.ErrorTypes.NETWORK_ERROR:\r\n          logError('A network error occured');\r\n          break;\r\n        default:\r\n          logError('An unrecoverable error occured');\r\n          hls.destroy();\r\n          break;\r\n      }\r\n    }\r\n    if(!stats) {\r\n      stats = {};\r\n    }\r\n    // track all errors independently\r\n    if (stats[data.details] === undefined)\r\n    {stats[data.details] = 1;}\r\n    else\r\n    {stats[data.details] += 1;}\r\n\r\n    // track fatal error\r\n    if (data.fatal) {\r\n      if (stats.fatalError === undefined) {\r\n        stats.fatalError = 1;\r\n      } else {\r\n        stats.fatalError += 1;\r\n      }\r\n    }\r\n    $('#statisticsOut').text(JSON.stringify(sortObject(stats), null, '\\t'));\r\n  });\r\n\r\n  hls.on(Hls.Events.BUFFER_CREATED, function(event, data) {\r\n    tracks = data.tracks;\r\n  });\r\n\r\n  hls.on(Hls.Events.BUFFER_APPENDING, function(event, data) {\r\n    if (dumpfMP4) {\r\n      fmp4Data[data.type].push(data.data);\r\n    }\r\n  });\r\n\r\n  hls.on(Hls.Events.FPS_DROP, function(event, data) {\r\n    let evt = {\r\n      time: performance.now() - events.t0,\r\n      type: 'frame drop',\r\n      name: data.currentDropped + '/' + data.currentDecoded\r\n    };\r\n    events.video.push(evt);\r\n    trimEventHistory();\r\n    if (stats) {\r\n      if (stats.fpsDropEvent === undefined)\r\n      {stats.fpsDropEvent = 1;}\r\n      else\r\n      {stats.fpsDropEvent++;}\r\n\r\n      stats.fpsTotalDroppedFrames = data.totalDroppedFrames;\r\n    }\r\n  });\r\n\r\n  video.addEventListener('resize', handleVideoEvent);\r\n  video.addEventListener('seeking', handleVideoEvent);\r\n  video.addEventListener('seeked', handleVideoEvent);\r\n  video.addEventListener('pause', handleVideoEvent);\r\n  video.addEventListener('play', handleVideoEvent);\r\n  video.addEventListener('canplay', handleVideoEvent);\r\n  video.addEventListener('canplaythrough', handleVideoEvent);\r\n  video.addEventListener('ended', handleVideoEvent);\r\n  video.addEventListener('playing', handleVideoEvent);\r\n  video.addEventListener('error', handleVideoEvent);\r\n  video.addEventListener('loadedmetadata', handleVideoEvent);\r\n  video.addEventListener('loadeddata', handleVideoEvent);\r\n  video.addEventListener('durationchange', handleVideoEvent);\r\n}\r\n\r\nfunction handleUnsupported() {\r\n  if(navigator.userAgent.toLowerCase().indexOf('firefox') !== -1) {\r\n    logStatus('You are using Firefox, it looks like MediaSource is not enabled,<br>please ensure the following keys are set appropriately in <b>about:config</b><br>media.mediasource.enabled=true<br>media.mediasource.mp4.enabled=true<br><b>media.mediasource.whitelist=false</b>');\r\n  } else {\r\n    logStatus('Your Browser does not support MediaSourceExtension / MP4 mediasource');\r\n  }\r\n}\r\n\r\nfunction handleVideoEvent(evt) {\r\n  let data = '';\r\n  switch(evt.type) {\r\n    case 'durationchange':\r\n      if(evt.target.duration - lastDuration <= 0.5) {\r\n        // some browsers report several duration change events with almost the same value ... avoid spamming video events\r\n        return;\r\n      }\r\n      lastDuration = evt.target.duration;\r\n      data = Math.round(evt.target.duration*1000);\r\n      break;\r\n    case 'resize':\r\n      data = evt.target.videoWidth + '/' + evt.target.videoHeight;\r\n      break;\r\n    case 'loadedmetadata':\r\n    case 'loadeddata':\r\n    case 'canplay':\r\n    case 'canplaythrough':\r\n    case 'ended':\r\n    case 'seeking':\r\n    case 'seeked':\r\n    case 'play':\r\n    case 'playing':\r\n      lastStartPosition = evt.target.currentTime;\r\n    case 'pause':\r\n    case 'waiting':\r\n    case 'stalled':\r\n    case 'error':\r\n      data = Math.round(evt.target.currentTime*1000);\r\n      if(evt.type === 'error') {\r\n        let errorTxt, mediaError=evt.currentTarget.error;\r\n        switch(mediaError.code) {\r\n          case mediaError.MEDIA_ERR_ABORTED:\r\n            errorTxt = 'You aborted the video playback';\r\n            break;\r\n          case mediaError.MEDIA_ERR_DECODE:\r\n            errorTxt = 'The video playback was aborted due to a corruption problem or because the video used features your browser did not support';\r\n            handleMediaError();\r\n            break;\r\n          case mediaError.MEDIA_ERR_NETWORK:\r\n            errorTxt = 'A network error caused the video download to fail part-way';\r\n            break;\r\n          case mediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:\r\n            errorTxt = 'The video could not be loaded, either because the server or network failed or because the format is not supported';\r\n            break;\r\n        }\r\n\r\n        if (mediaError.message) {\r\n          errorTxt += ' - ' + mediaError.message;\r\n        }\r\n\r\n        logStatus(errorTxt);\r\n        console.error(errorTxt);\r\n      }\r\n      break;\r\n    default:\r\n      break;\r\n  }\r\n\r\n  let event = {\r\n    time: performance.now() - events.t0,\r\n    type: evt.type,\r\n    name: data\r\n  };\r\n\r\n  events.video.push(event);\r\n  if(evt.type === 'seeking') {\r\n    lastSeekingIdx = events.video.length-1;\r\n  }\r\n\r\n  if(evt.type === 'seeked') {\r\n    events.video[lastSeekingIdx].duration = event.time - events.video[lastSeekingIdx].time;\r\n  }\r\n\r\n  trimEventHistory();\r\n}\r\n\r\nfunction handleMediaError() {\r\n  if(autoRecoverError) {\r\n    let now = performance.now();\r\n    if(!recoverDecodingErrorDate || (now - recoverDecodingErrorDate) > 3000) {\r\n      recoverDecodingErrorDate = performance.now();\r\n      $('#statusOut').append(', trying to recover media error.');\r\n      hls.recoverMediaError();\r\n    } else {\r\n      if(!recoverSwapAudioCodecDate || (now - recoverSwapAudioCodecDate) > 3000) {\r\n        recoverSwapAudioCodecDate = performance.now();\r\n        $('#statusOut').append(', trying to swap audio codec and recover media error.');\r\n        hls.swapAudioCodec();\r\n        hls.recoverMediaError();\r\n      } else {\r\n        $('#statusOut').append(', cannot recover. Last media error recovery failed.');\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction timeRangesToString(r) {\r\n  let log = '';\r\n  for (let i=0; i<r.length; i++) {\r\n    log += '[' + r.start(i) + ', ' + r.end(i) + ']';\r\n    log += ' ';\r\n  }\r\n  return log;\r\n}\r\n\r\nfunction checkBuffer() {\r\n  let v = $('#video')[0];\r\n  let canvas = $('#bufferedCanvas')[0];\r\n  let ctx = canvas.getContext('2d');\r\n  let r = v.buffered;\r\n  let bufferingDuration;\r\n  ctx.fillStyle = 'black';\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n  ctx.fillStyle = 'gray';\r\n  if (r) {\r\n    if(!canvas.width || canvas.width !== v.clientWidth)\r\n    {canvas.width = v.clientWidth;}\r\n\r\n    var pos = v.currentTime, bufferLen;\r\n    for (var i=0, bufferLen=0; i<r.length; i++) {\r\n      let start = r.start(i)/v.duration * canvas.width;\r\n      let end = r.end(i)/v.duration * canvas.width;\r\n      ctx.fillRect(start, 3, Math.max(2, end-start), 10);\r\n      if(pos >= r.start(i) && pos < r.end(i)) {\r\n        // play position is inside this buffer TimeRange, retrieve end of buffer position and buffer length\r\n        bufferLen = r.end(i) - pos;\r\n      }\r\n    }\r\n    // check if we are in buffering / or playback ended state\r\n    if(bufferLen <= 0.1 && v.paused === false && (pos-lastStartPosition) > 0.5) {\r\n      // don't create buffering event if we are at the end of the playlist, don't report ended for live playlist\r\n      if(lastDuration -pos <= 0.5  && events.isLive === false) {\r\n      } else {\r\n        // we are not at the end of the playlist ... real buffering\r\n        if(bufferingIdx !== -1) {\r\n          bufferingDuration = performance.now() - events.t0 - events.video[bufferingIdx].time;\r\n          events.video[bufferingIdx].duration = bufferingDuration;\r\n          events.video[bufferingIdx].name = bufferingDuration;\r\n        } else {\r\n          events.video.push({\r\n            type: 'buffering',\r\n            time: performance.now() - events.t0\r\n          });\r\n          trimEventHistory();\r\n          // we are in buffering state\r\n          bufferingIdx = events.video.length-1;\r\n        }\r\n      }\r\n    }\r\n\r\n    if(bufferLen > 0.1 && bufferingIdx !=-1) {\r\n      bufferingDuration = performance.now() - events.t0 - events.video[bufferingIdx].time;\r\n      events.video[bufferingIdx].duration = bufferingDuration;\r\n      events.video[bufferingIdx].name = bufferingDuration;\r\n      // we are out of buffering state\r\n      bufferingIdx = -1;\r\n    }\r\n\r\n    // update buffer/position for current Time\r\n    let event = {\r\n      time  : performance.now() - events.t0,\r\n      buffer: Math.round(bufferLen*1000),\r\n      pos   : Math.round(pos*1000)\r\n    };\r\n    let bufEvents = events.buffer, bufEventLen = bufEvents.length;\r\n    if(bufEventLen > 1) {\r\n      let event0 = bufEvents[bufEventLen-2], event1 = bufEvents[bufEventLen-1];\r\n      let slopeBuf0 = (event0.buffer - event1.buffer)/(event0.time-event1.time);\r\n      let slopeBuf1 = (event1.buffer - event.buffer)/(event1.time-event.time);\r\n\r\n      let slopePos0 = (event0.pos - event1.pos)/(event0.time-event1.time);\r\n      let slopePos1 = (event1.pos - event.pos)/(event1.time-event.time);\r\n      // compute slopes. if less than 30% difference, remove event1\r\n      if((slopeBuf0 === slopeBuf1 || Math.abs(slopeBuf0/slopeBuf1 -1) <= 0.3) &&\r\n           (slopePos0 === slopePos1 || Math.abs(slopePos0/slopePos1 -1) <= 0.3))\r\n      {bufEvents.pop();}\r\n\r\n    }\r\n    events.buffer.push(event);\r\n    trimEventHistory();\r\n    refreshCanvas();\r\n\r\n    let log = 'Duration: '\r\n              + v.duration + '\\n'\r\n              + 'Buffered: '\r\n              + timeRangesToString(v.buffered) + '\\n'\r\n              + 'Seekable: '\r\n              + timeRangesToString(v.seekable) + '\\n'\r\n              + 'Played: '\r\n              + timeRangesToString(v.played) + '\\n';\r\n\r\n    if (hls.media) {\r\n      for(let type in tracks) {\r\n        log += 'Buffer for ' + type + ' contains: ' + timeRangesToString(tracks[type].buffer.buffered) + '\\n';\r\n      }\r\n\r\n      const videoPlaybackQuality = v.getVideoPlaybackQuality;\r\n      if(videoPlaybackQuality && typeof (videoPlaybackQuality) === typeof (Function)) {\r\n        log += 'Dropped frames: '+ v.getVideoPlaybackQuality().droppedVideoFrames + '\\n';\r\n        log += 'Corrupted frames:'+ v.getVideoPlaybackQuality().corruptedVideoFrames + '\\n';\r\n      } else if(v.webkitDroppedFrameCount) {\r\n        log+='Dropped frames:'+ v.webkitDroppedFrameCount + '\\n';\r\n      }\r\n    }\r\n    $('#bufferedOut').text(log);\r\n\r\n    $('#statisticsOut').text(JSON.stringify(sortObject(stats), null, '\\t'));\r\n\r\n    ctx.fillStyle = 'blue';\r\n\r\n    const x = v.currentTime / v.duration * canvas.width;\r\n    ctx.fillRect(x, 0, 2, 15);\r\n  }\r\n\r\n}\r\n\r\nfunction showCanvas()  {\r\n  showMetrics();\r\n  $('#bufferedOut').show();\r\n  $('#bufferedCanvas').show();\r\n}\r\n\r\nfunction hideCanvas()  {\r\n  hideMetrics();\r\n  $('#bufferedOut').hide();\r\n  $('#bufferedCanvas').hide();\r\n}\r\n\r\nfunction getMetrics() {\r\n  let json = JSON.stringify(events);\r\n  let jsonpacked = jsonpack.pack(json);\r\n  // console.log('packing JSON from ' + json.length + ' to ' + jsonpacked.length + ' bytes');\r\n  return btoa(jsonpacked);\r\n}\r\n\r\nfunction copyMetricsToClipBoard() {\r\n  copyTextToClipboard(getMetrics());\r\n}\r\n\r\nfunction goToMetrics() {\r\n  let url = document.URL;\r\n  url = url.substr(0, url.lastIndexOf('/')+1) + 'metrics.html';\r\n  window.open(url, '_blank');\r\n}\r\n\r\nfunction goToMetricsPermaLink() {\r\n  let url = document.URL;\r\n  let b64 = getMetrics();\r\n  url = url.substr(0, url.lastIndexOf('/')+1) + 'metrics.html#data=' + b64;\r\n  window.open(url, '_blank');\r\n}\r\n\r\nfunction minsecs(ts) {\r\n  let m = Math.floor(Math.floor(ts % 3600) / 60);\r\n  let s = Math.floor(ts % 60);\r\n  return m + ':' + (s < 10 ? '0' : '') + s;\r\n}\r\n\r\nfunction onClickBufferedRange(event) {\r\n  let canvas = $('#bufferedCanvas')[0];\r\n  let v = $('#video')[0];\r\n  let target = (event.clientX - canvas.offsetLeft) / canvas.width * v.duration;\r\n  v.currentTime = target;\r\n}\r\n\r\nfunction updateLevelInfo() {\r\n\r\n  if (!hls.levels) {\r\n    return;\r\n  }\r\n\r\n  let button_template = '<button type=\"button\" class=\"btn btn-sm ';\r\n  let button_enabled  = 'btn-primary\" ';\r\n  let button_disabled = 'btn-success\" ';\r\n\r\n  let html1 = button_template;\r\n  if(hls.autoLevelEnabled) {\r\n    html1 += button_enabled;\r\n  } else {\r\n    html1 += button_disabled;\r\n  }\r\n\r\n  html1 += 'onclick=\"hls.currentLevel=-1\">auto</button>';\r\n\r\n  let html2 = button_template;\r\n  if(hls.autoLevelEnabled) {\r\n    html2 += button_enabled;\r\n  } else {\r\n    html2 += button_disabled;\r\n  }\r\n\r\n  html2 += 'onclick=\"hls.loadLevel=-1\">auto</button>';\r\n\r\n  let html3 = button_template;\r\n  if(hls.autoLevelCapping === -1) {\r\n    html3 += button_enabled;\r\n  } else {\r\n    html3 += button_disabled;\r\n  }\r\n\r\n  html3 += 'onclick=\"levelCapping=hls.autoLevelCapping=-1;updateLevelInfo();onDemoConfigChanged();\">auto</button>';\r\n\r\n  let html4 = button_template;\r\n  if(hls.autoLevelEnabled) {\r\n    html4 += button_enabled;\r\n  } else {\r\n    html4 += button_disabled;\r\n  }\r\n\r\n  html4 += 'onclick=\"hls.nextLevel=-1\">auto</button>';\r\n\r\n  for (let i=0; i < hls.levels.length; i++) {\r\n    html1 += button_template;\r\n    if(hls.currentLevel === i) {\r\n      html1 += button_enabled;\r\n    } else {\r\n      html1 += button_disabled;\r\n    }\r\n\r\n    let levelName = i;\r\n    let label = level2label(i);\r\n    if(label) {\r\n      levelName += ' (' + level2label(i) + 'p)';\r\n    }\r\n\r\n    html1 += 'onclick=\"hls.currentLevel=' + i + '\">' + levelName + '</button>';\r\n\r\n    html2 += button_template;\r\n    if(hls.loadLevel === i) {\r\n      html2 += button_enabled;\r\n    } else {\r\n      html2 += button_disabled;\r\n    }\r\n\r\n    html2 += 'onclick=\"hls.loadLevel=' + i + '\">' + levelName + '</button>';\r\n\r\n    html3 += button_template;\r\n    if(hls.autoLevelCapping === i) {\r\n      html3 += button_enabled;\r\n    } else {\r\n      html3 += button_disabled;\r\n    }\r\n\r\n    html3 += 'onclick=\"levelCapping=hls.autoLevelCapping=' + i + ';updateLevelInfo();onDemoConfigChanged();\">' + levelName + '</button>';\r\n\r\n    html4 += button_template;\r\n    if(hls.nextLevel === i) {\r\n      html4 += button_enabled;\r\n    } else {\r\n      html4 += button_disabled;\r\n    }\r\n\r\n    html4 += 'onclick=\"hls.nextLevel=' + i + '\">' + levelName + '</button>';\r\n  }\r\n\r\n  let v = $('#video')[0];\r\n\r\n  if(v.videoWidth && v.videoHeight) {\r\n    $('#currentResolution').html(v.videoWidth + ' x ' + v.videoHeight);\r\n  }\r\n\r\n  if($('#currentLevelControl').html() != html1) {\r\n    $('#currentLevelControl').html(html1);\r\n  }\r\n\r\n  if($('#loadLevelControl').html() != html2) {\r\n    $('#loadLevelControl').html(html2);\r\n  }\r\n\r\n  if($('#levelCappingControl').html() != html3) {\r\n    $('#levelCappingControl').html(html3);\r\n  }\r\n\r\n  if($('#nextLevelControl').html() != html4) {\r\n    $('#nextLevelControl').html(html4);\r\n  }\r\n}\r\n\r\nfunction updateAudioTrackInfo() {\r\n  let button_template = '<button type=\"button\" class=\"btn btn-sm ';\r\n  let button_enabled  = 'btn-primary\" ';\r\n  let button_disabled = 'btn-success\" ';\r\n  let html1 = '';\r\n  let audioTrackId = hls.audioTrack, len = hls.audioTracks.length;\r\n\r\n  for (let i=0; i < len; i++) {\r\n    html1 += button_template;\r\n    if(audioTrackId === i) {\r\n      html1 += button_enabled;\r\n    } else {\r\n      html1 += button_disabled;\r\n    }\r\n\r\n    html1 += 'onclick=\"hls.audioTrack=' + i + '\">' + hls.audioTracks[i].name + '</button>';\r\n  }\r\n  $('#audioTrackControl').html(html1);\r\n}\r\n\r\nfunction level2label(index) {\r\n  if(hls && hls.levels.length-1 >= index) {\r\n    let level = hls.levels[index];\r\n    if (level.name) {\r\n      return level.name;\r\n    } else {\r\n      if (level.height) {\r\n        return(level.height + 'p / ' + Math.round(level.bitrate / 1024) + 'kb');\r\n      } else {\r\n        if(level.bitrate) {\r\n          return(Math.round(level.bitrate / 1024) + 'kb');\r\n        } else {\r\n          return null;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction getDemoConfigPropOrDefault(propName, defaultVal) {\r\n  return typeof demoConfig[propName] !== 'undefined' ? demoConfig[propName] : defaultVal;\r\n}\r\n\r\nfunction getURLParam(sParam, defaultValue) {\r\n  let sPageURL = window.location.search.substring(1);\r\n  let sURLVariables = sPageURL.split('&');\r\n  for (let i = 0; i < sURLVariables.length; i++) {\r\n    let sParameterName = sURLVariables[i].split('=');\r\n    if (sParameterName[0] == sParam)\r\n    {return 'undefined' == sParameterName[1] ? undefined : 'false' == sParameterName[1] ? false : sParameterName[1];}\r\n\r\n  }\r\n  return defaultValue;\r\n}\r\n\r\nfunction onDemoConfigChanged() {\r\n  demoConfig = {\r\n    enableStreaming,\r\n    autoRecoverError,\r\n    dumpfMP4,\r\n    levelCapping,\r\n    limitMetrics,\r\n  };\r\n\r\n  if (configPersistenceEnabled) {\r\n    persistEditorValue();\r\n  }\r\n\r\n  const serializedDemoConfig = btoa(JSON.stringify(demoConfig));\r\n  const baseURL = document.URL.split('?')[0];\r\n  const streamURL = $('#streamURL').val();\r\n  const permalinkURL = `${baseURL}?src=${encodeURIComponent(streamURL)}&demoConfig=${serializedDemoConfig}`;\r\n\r\n  $('#StreamPermalink').html(`<a href=\"${permalinkURL}\">${permalinkURL}</a>`);\r\n}\r\n\r\nfunction onConfigPersistenceChanged(event) {\r\n  configPersistenceEnabled = event.target.checked;\r\n  localStorage.setItem(STORAGE_KEYS.Editor_Persistence, JSON.stringify(configPersistenceEnabled));\r\n\r\n  if (configPersistenceEnabled) {\r\n    persistEditorValue();\r\n  } else {\r\n    localStorage.removeItem(STORAGE_KEYS.Hls_Config);\r\n  }\r\n}\r\n\r\nfunction getEditorValue(options) {\r\n  options = $.extend({ parse: false }, options || {});\r\n  let value = configEditor.session.getValue();\r\n\r\n  if (options.parse) {\r\n    try {\r\n      value = JSON.parse(value);\r\n    } catch (e) {\r\n      console.warn('[getEditorValue] could not parse editor value', e);\r\n      value = {};\r\n    }\r\n  }\r\n\r\n  return value;\r\n}\r\n\r\nfunction getPersistedHlsConfig() {\r\n  var value = localStorage.getItem(STORAGE_KEYS.Hls_Config);\r\n\r\n  if (value === null) {\r\n    return value;\r\n  }\r\n\r\n  try {\r\n    value = JSON.parse(value);\r\n  } catch (e) {\r\n    console.warn('[getPersistedHlsConfig] could not hls config json', e);\r\n    value = {};\r\n  }\r\n\r\n  return value;\r\n}\r\n\r\nfunction persistEditorValue() {\r\n  localStorage.setItem(STORAGE_KEYS.Hls_Config, getEditorValue());\r\n}\r\n\r\nfunction setupConfigEditor() {\r\n  configEditor = ace.edit('config-editor');\r\n  configEditor.setTheme('ace/theme/github');\r\n  configEditor.session.setMode('ace/mode/json');\r\n\r\n  const contents = hlsjsDefaults;\r\n  const shouldRestorePersisted = JSON.parse(localStorage.getItem(STORAGE_KEYS.Editor_Persistence)) === true;\r\n\r\n  if (shouldRestorePersisted) {\r\n    $.extend(contents, getPersistedHlsConfig());\r\n  }\r\n\r\n  const elPersistence = document.querySelector('#configPersistence');\r\n  elPersistence.addEventListener('change', onConfigPersistenceChanged);\r\n  elPersistence.checked = shouldRestorePersisted;\r\n  configPersistenceEnabled = shouldRestorePersisted;\r\n\r\n  updateConfigEditorValue(contents);\r\n}\r\n\r\nfunction updateConfigEditorValue(obj) {\r\n  const json = JSON.stringify(obj, null, 2);\r\n  configEditor.session.setValue(json);\r\n}\r\n\r\nfunction applyConfigEditorValue() {\r\n  onDemoConfigChanged();\r\n  loadSelectedStream();\r\n}\r\n\r\nfunction createfMP4(type) {\r\n  if (fmp4Data[type].length) {\r\n    let blob = new Blob([arrayConcat(fmp4Data[type])], {\r\n      type: 'application/octet-stream'\r\n    });\r\n    let filename = type + '-' + new Date().toISOString() + '.mp4';\r\n    saveAs(blob, filename);\r\n    //$('body').append('<a download=\"hlsjs-' + filename + '\" href=\"' + window.URL.createObjectURL(blob) + '\">Download ' + filename + ' track</a><br>');\r\n  }\r\n}\r\n\r\nfunction arrayConcat(inputArray) {\r\n  let totalLength = inputArray.reduce( function(prev, cur) { return prev+cur.length; }, 0);\r\n  let result = new Uint8Array(totalLength);\r\n  let offset = 0;\r\n  inputArray.forEach(function(element) {\r\n    result.set(element, offset);\r\n    offset += element.length;\r\n  });\r\n  return result;\r\n}\r\n\r\nfunction hideAllTabs() {\r\n  $('#playbackControlTab').hide();\r\n  $('#qualityLevelControlTab').hide();\r\n  $('#audioTrackControlTab').hide();\r\n  $('#metricsDisplayTab').hide();\r\n  $('#statsDisplayTab').hide();\r\n}\r\n\r\nfunction toggleTab(tabElId) {\r\n  hideAllTabs();\r\n  hideMetrics();\r\n  $('#' + tabElId).show();\r\n}\r\n\r\nfunction appendLog(textElId, message) {\r\n  const el = $('#' + textElId)\r\n  let logText = el.text()\r\n  if (logText.length) {\r\n    logText += '\\n'\r\n  }\r\n  const timestamp = (Date.now() - startTime) / 1000\r\n  const newMessage = timestamp + ' | ' + message\r\n  logText += newMessage\r\n  // update\r\n  el.text(logText)\r\n}\r\n\r\nfunction logStatus(message) {\r\n  appendLog('statusOut', message)\r\n}\r\n\r\nfunction logError(message) {\r\n  appendLog('errorOut', message)\r\n}\r\n","/**\r\n * Create test stream\r\n * @param {string} url\r\n * @param {string} description\r\n * @param {boolean} [live]\r\n * @param {boolean} [abr]\r\n * @param {string[]} [blacklist_ua]\r\n * @returns {{url: string, description: string, live: boolean, abr: boolean, blacklist_ua: string[]}}\r\n */\r\nfunction createTestStream (url, description, live = false, abr = true, blacklist_ua = []) {\r\n  return {\r\n    url,\r\n    description,\r\n    live,\r\n    abr,\r\n    blacklist_ua\r\n  };\r\n}\r\n\r\n/**\r\n * @param {Object} target\r\n * @param {Object} [config]\r\n * @returns {{url: string, description: string, live: boolean, abr: boolean, blacklist_ua: string[]}}\r\n */\r\nfunction createTestStreamWithConfig (target, config) {\r\n  if (typeof target !== 'object') {\r\n    throw new Error('target should be object');\r\n  }\r\n\r\n  const testStream = createTestStream(target.url, target.description, target.live, target.abr, target.blacklist_ua);\r\n\r\n  testStream.config = config;\r\n\r\n  return testStream;\r\n}\r\n\r\nmodule.exports = {\r\n  bbb: createTestStreamWithConfig({\r\n    url: 'https://video-dev.github.io/streams/x36xhzz/x36xhzz.m3u8',\r\n    description: 'Big Buck Bunny - adaptive qualities'\r\n  },\r\n  {\r\n    // try to workaround test failing because of slow seek on Chrome/Win10\r\n    nudgeMaxRetry: 5\r\n  }\r\n  ),\r\n  bigBuckBunny480p: {\r\n    'url': 'https://video-dev.github.io/streams/x36xhzz/url_6/193039199_mp4_h264_aac_hq_7.m3u8',\r\n    'description': 'Big Buck Bunny - 480p only',\r\n    'live': false,\r\n    'abr': false,\r\n    'blacklist_ua': ['internet explorer']\r\n  },\r\n  arte: {\r\n    'url': 'https://video-dev.github.io/streams/test_001/stream.m3u8',\r\n    'description': 'ARTE China,ABR',\r\n    'live': false,\r\n    'abr': true\r\n  },\r\n  deltatreDAI: {\r\n    'url': 'https://video-dev.github.io/streams/dai-discontinuity-deltatre/manifest.m3u8',\r\n    'description': 'Ad-insertion in event stream',\r\n    'live': false,\r\n    'abr': false,\r\n    'blacklist_ua': ['internet explorer']\r\n  },\r\n  issue666: {\r\n    'url': 'https://video-dev.github.io/streams/issue666/playlists/cisq0gim60007xzvi505emlxx.m3u8',\r\n    'description': 'hls.js/issues/666',\r\n    'live': false,\r\n    'abr': false,\r\n    'blacklist_ua': ['internet explorer']\r\n  },\r\n  /* // went offline for us :( would be good to replace this for regression test with something mimicking the issue\r\n  issue649: {\r\n    'url': 'https://cdn3.screen9.com/media/c/W/cW87csHkxsgu5TV1qs78aA_auto_hls.m3u8?auth=qlUjeCtbVdtkDfZYrtveTIVUXX1yuSqgF8wfWabzKpX72r-d5upW88-FHuyRRdnZA_1PKRTGAtTt_6Z-aj22kw',\r\n    'description': 'hls.js/issues/649',\r\n    'live': false,\r\n    'abr': false\r\n  },\r\n  */\r\n  closedCaptions: {\r\n    'url': 'https://playertest.longtailvideo.com/adaptive/captions/playlist.m3u8',\r\n    'description': 'CNN special report, with CC',\r\n    'live': false,\r\n    'abr': false,\r\n    'blacklist_ua': ['safari']\r\n  },\r\n  oceansAES: {\r\n    'url': 'https://playertest.longtailvideo.com/adaptive/oceans_aes/oceans_aes.m3u8',\r\n    'description': 'AES encrypted,ABR',\r\n    'live': false,\r\n    'abr': true\r\n  },\r\n  /*\r\n  bbbAES: {\r\n    'url': 'https://video-dev.github.io/streams/bbbAES/playlists/sample_aes/index.m3u8',\r\n    'description': 'SAMPLE-AES encrypted',\r\n    'live': false,\r\n    'abr': false\r\n  },\r\n  */\r\n  mp3Audio: {\r\n    'url': 'https://player.webvideocore.net/CL1olYogIrDWvwqiIKK7eLBkzvO18gwo9ERMzsyXzwt_t-ya8ygf2kQBZww38JJT/8i4vvznv8408.m3u8',\r\n    'description': 'MP3 VOD demo',\r\n    'live': false,\r\n    'abr': false,\r\n    'blacklist_ua': ['safari']\r\n  },\r\n  mpegAudioOnly: {\r\n    'url': 'https://pl.streamingvideoprovider.com/mp3-playlist/playlist.m3u8',\r\n    'description': 'MPEG Audio Only demo',\r\n    'live': false,\r\n    'abr': false,\r\n    'blacklist_ua': ['internet explorer', 'MicrosoftEdge', 'safari', 'firefox']\r\n  },\r\n  fmp4: {\r\n    'url': 'https://storage.googleapis.com/shaka-demo-assets/angel-one-hls/hls.m3u8',\r\n    'description': 'HLS fMP4 Angel-One multiple audio-tracks',\r\n    'live': false,\r\n    'abr': false,\r\n    'blacklist_ua': ['safari', 'internet explorer']\r\n  },\r\n  fmp4Bitmovin: {\r\n    'url': 'https://bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s-fmp4/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8',\r\n    'description': 'HLS fMP4 by Bitmovin',\r\n    'live': false,\r\n    'abr': true,\r\n    'blacklist_ua': ['safari', 'internet explorer']\r\n  },\r\n  offset_pts: {\r\n    'url': 'https://video-dev.github.io/streams/pts_shift/master.m3u8',\r\n    'description': 'DK Turntable, PTS shifted by 2.3s',\r\n    'live': false,\r\n    'abr': false\r\n  },\r\n  /*\r\n  uspHLSAteam: createTestStream(\r\n    'http://demo.unified-streaming.com/video/ateam/ateam.ism/ateam.m3u8?session_id=27199',\r\n    'A-Team movie trailer - HLS by Unified Streaming Platform'\r\n  ),\r\n  */\r\n  angelOneShakaWidevine: createTestStreamWithConfig({\r\n    url: 'https://storage.googleapis.com/shaka-demo-assets/angel-one-widevine-hls/hls.m3u8',\r\n    description: 'Shaka-packager Widevine DRM (EME) HLS-fMP4 - Angel One Demo',\r\n    blacklist_ua: ['firefox', 'safari', 'internet explorer']\r\n  },\r\n  {\r\n    emeEnabled: true,\r\n    requestMediaKeySystemAccessFunc: function (supportedConfigurations) {\r\n      const keySystem = 'com.widevine.alpha';\r\n\r\n      return window.navigator.requestMediaKeySystemAccess(keySystem, supportedConfigurations);\r\n    },\r\n    getEMEInitializationDataFunc: function (levelOrAudioTrack, initDataType, initData) {\r\n      return Promise.resolve({\r\n        initDataType,\r\n        initData\r\n      });\r\n    },\r\n    getEMELicenseFunc: function (levelOrAudioTrack, event) {\r\n      const licenseServerUrl = 'https://cwip-shaka-proxy.appspot.com/no_auth';\r\n\r\n      const licenseXhr = new XMLHttpRequest();\r\n\r\n      const licensePromise = new Promise((resolve, reject) => {\r\n        licenseXhr.onload = function () {\r\n          resolve(this.response);\r\n        };\r\n\r\n        licenseXhr.onerror = function (err) {\r\n          if (err) {\r\n            reject(new Error('License request failed'));\r\n          }\r\n        };\r\n      });\r\n\r\n      licenseXhr.responseType = 'arraybuffer';\r\n\r\n      licenseXhr.open('POST', licenseServerUrl);\r\n\r\n      licenseXhr.send(event.message);\r\n\r\n      return licensePromise;\r\n    },\r\n    NOTE: 'Configuring EME requires the user to implement EME hooks. See API docs for more information'\r\n  }),\r\n  audioOnlyMultipleLevels: {\r\n    'url': 'https://s3.amazonaws.com/bob.jwplayer.com/~alex/121628/new_master.m3u8',\r\n    'description': 'Multiple non-alternate audio levels',\r\n    'live': false,\r\n    'abr': false\r\n  },\r\n  pdtDuplicate: {\r\n    url: 'https://playertest.longtailvideo.com/adaptive/artbeats/manifest.m3u8',\r\n    description: 'Stream with duplicate sequential PDT values'\r\n  },\r\n  pdtLargeGap: {\r\n    url: 'https://playertest.longtailvideo.com/adaptive/boxee/playlist.m3u8',\r\n    description: 'PDTs with large gaps following discontinuities'\r\n  },\r\n  pdtBadValues: {\r\n    url: 'https://playertest.longtailvideo.com/adaptive/progdatime/playlist2.m3u8',\r\n    description: 'PDTs with bad values'\r\n  },\r\n  pdtOneValue: {\r\n    url: 'https://playertest.longtailvideo.com/adaptive/aviion/manifest.m3u8',\r\n    description: 'One PDT, no discontinuities'\r\n  },\r\n  noTrackIntersection: {\r\n    url: 'https://s3.amazonaws.com/bob.jwplayer.com/%7Ealex/123633/new_master.m3u8',\r\n    description: 'Audio/video track PTS values do not intersect; 10 second start gap'\r\n  },\r\n  // altAudioNoVideoCodecSignaled: {\r\n  //   url: 'https://d35u71x3nb8v2y.cloudfront.net/4b711b97-513c-4d36-ad29-298ab23a2e5e/3cbf1114-b2f4-4320-afb3-f0f7eeeb8630/playlist.m3u8',\r\n  //   description: 'Alternate audio track, but no video codec is signaled in the master manifest'\r\n  // },\r\n  altAudioAndTracks: {\r\n    url: 'https://wowzaec2demo.streamlock.net/vod-multitrack/_definst_/smil:ElephantsDream/elephantsdream2.smil/playlist.m3u',\r\n    description: 'Alternate audio tracks, and multiple VTT tracks'\r\n  }\r\n};\r\n"],"sourceRoot":""}